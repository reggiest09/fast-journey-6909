!function(t){"use strict";t.fn.TouchSpin=function(e){var n={min:0,max:100,initval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-default",buttonup_class:"btn btn-default"};return this.each(function(){function i(){if(!P.data("alreadyinitialized")){if(P.data("alreadyinitialized",!0),!P.is("input"))return void console.log("Must be an input.");r(),o(),m(),l(),d(),p(),f()}}function o(){""!==x.initval&&""===P.val()&&P.val(x.initval)}function s(t){a(t),m();var e=Number(_.input.val());_.input.val(e.toFixed(x.decimals))}function r(){x=t.extend({},n,E,e)}function a(e){x=t.extend({},x,e)}function l(){var e=P.val(),n=P.parent();""!==e&&(e=Number(e).toFixed(x.decimals)),P.data("initvalue",e).val(e),P.addClass("form-control"),t("<style type='text/css'>.bootstrap-touchspin-prefix:empty,.bootstrap-touchspin-postfix:empty{display:none;}</style>").appendTo("head"),n.hasClass("input-group")?c(n):u()}function c(e){e.addClass("bootstrap-touchspin");var n,i,o=P.prev(),s=P.next(),r='<span class="input-group-addon bootstrap-touchspin-prefix">'+x.prefix+"</span>",a='<span class="input-group-addon bootstrap-touchspin-postfix">'+x.postfix+"</span>";o.hasClass("input-group-btn")?(n='<button class="'+x.buttondown_class+' bootstrap-touchspin-down" type="button">-</button>',o.append(n)):(n='<span class="input-group-btn"><button class="'+x.buttondown_class+' bootstrap-touchspin-down" type="button">-</button></span>',t(n).insertBefore(P)),s.hasClass("input-group-btn")?(i='<button class="'+x.buttonup_class+' bootstrap-touchspin-up" type="button">+</button>',s.prepend(i)):(i='<span class="input-group-btn"><button class="'+x.buttonup_class+' bootstrap-touchspin-up" type="button">+</button></span>',t(i).insertAfter(P)),t(r).insertBefore(P),t(a).insertAfter(P),C=e}function u(){var e='<div class="input-group bootstrap-touchspin"><span class="input-group-btn"><button class="'+x.buttondown_class+' bootstrap-touchspin-down" type="button">-</button></span><span class="input-group-addon bootstrap-touchspin-prefix">'+x.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+x.postfix+'</span><span class="input-group-btn"><button class="'+x.buttonup_class+' bootstrap-touchspin-up" type="button">+</button></span></div>';C=t(e).insertBefore(P),t(".bootstrap-touchspin-prefix",C).after(P),P.hasClass("input-sm")?C.addClass("input-group-sm"):P.hasClass("input-lg")&&C.addClass("input-group-lg")}function d(){_={down:t(".bootstrap-touchspin-down",C),up:t(".bootstrap-touchspin-up",C),input:t("input",C),prefix:t(".bootstrap-touchspin-prefix",C).addClass(x.prefix_extraclass),postfix:t(".bootstrap-touchspin-postfix",C).addClass(x.postfix_extraclass)}}function p(){P.on("keydown",function(t){var e=t.keyCode||t.which;38===e?("up"!==O&&(v(),w()),t.preventDefault()):40===e&&("down"!==O&&(b(),y()),t.preventDefault())}),P.on("keyup",function(t){var e=t.keyCode||t.which;38===e?S():40===e&&S()}),P.on("blur",function(){m()}),_.down.on("keydown",function(t){var e=t.keyCode||t.which;32!==e&&13!==e||("down"!==O&&(b(),y()),t.preventDefault())}),_.down.on("keyup",function(t){var e=t.keyCode||t.which;32!==e&&13!==e||S()}),_.up.on("keydown",function(t){var e=t.keyCode||t.which;32!==e&&13!==e||("up"!==O&&(v(),w()),t.preventDefault())}),_.up.on("keyup",function(t){var e=t.keyCode||t.which;32!==e&&13!==e||S()}),_.down.on("mousedown touchstart",function(t){b(),y(),t.preventDefault(),t.stopPropagation()}),_.up.on("mousedown touchstart",function(t){v(),w(),t.preventDefault(),t.stopPropagation()}),_.up.on("mouseout touchleave touchend touchcancel",function(t){O&&(t.stopPropagation(),S())}),_.down.on("mouseout touchleave touchend touchcancel",function(t){O&&(t.stopPropagation(),S())}),_.down.on("mousemove touchmove",function(t){O&&(t.stopPropagation(),t.preventDefault())}),_.up.on("mousemove touchmove",function(t){O&&(t.stopPropagation(),t.preventDefault())}),t(document).on("mouseup touchend touchcancel",function(t){O&&(t.preventDefault(),S())}),t(document).on("mousemove touchmove scroll scrollstart",function(t){O&&(t.preventDefault(),S())}),x.mousewheel&&P.on("mousewheel DOMMouseScroll",function(t){var e=t.originalEvent.wheelDelta||-t.originalEvent.detail;t.stopPropagation(),t.preventDefault(),e<0?b():v()})}function f(){P.on("touchspin.uponce",function(){S(),v()}),P.on("touchspin.downonce",function(){S(),b()}),P.on("touchspin.startupspin",function(){w()}),P.on("touchspin.startdownspin",function(){y()}),P.on("touchspin.stopspin",function(){S()}),P.on("touchspin.updatesettings",function(t,e){s(e)})}function h(t){switch(x.forcestepdivisibility){case"round":return(Math.round(t/x.step)*x.step).toFixed(x.decimals);case"floor":return(Math.floor(t/x.step)*x.step).toFixed(x.decimals);case"ceil":return(Math.ceil(t/x.step)*x.step).toFixed(x.decimals);default:return t}}function m(){var t,e,n;t=P.val(),""!==t&&(x.decimals>0&&"."===t||(e=parseFloat(t),isNaN(e)&&(e=0),n=e,e.toString()!==t&&(n=e),e<x.min&&(n=x.min),e>x.max&&(n=x.max),n=h(n),Number(t).toString()!==n.toString()&&(P.val(n),P.trigger("change"))))}function g(){if(x.booster){var t=Math.pow(2,Math.floor(D/x.boostat))*x.step;return x.maxboostedstep&&t>x.maxboostedstep&&(t=x.maxboostedstep,$=Math.round($/t*t)),Math.max(x.step,t)}return x.step}function v(){m(),$=parseFloat(_.input.val()),isNaN($)&&($=0);var t=$,e=g();$+=e,$>x.max&&(S(),$=x.max,P.trigger("touchspin.max")),_.input.val(Number($).toFixed(x.decimals)),t!==$&&P.trigger("change")}function b(){m(),$=parseFloat(_.input.val()),isNaN($)&&($=0);var t=$,e=g();$-=e,$<x.min&&(S(),$=x.min,P.trigger("touchspin.min")),_.input.val($.toFixed(x.decimals)),t!==$&&P.trigger("change")}function y(){S(),D=0,O="down",I=setTimeout(function(){T=setInterval(function(){D++,b()},x.stepinterval)},x.stepintervaldelay)}function w(){S(),D=0,O="up",A=setTimeout(function(){k=setInterval(function(){D++,v()},x.stepinterval)},x.stepintervaldelay)}function S(){clearTimeout(I),clearTimeout(A),clearInterval(T),clearInterval(k),D=0,O=!1}var x,C,_,$,T,k,I,A,P=t(this),E=P.data(),D=0,O=!1;i()})}}(jQuery);